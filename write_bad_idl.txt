pro write_comp_list, outfile, indexlist, id, ts, cam, typ, condField
	for i=0,n_elements(indexlist)-1 do $
		printf,outfile,id[indexlist[i]],' time:',ts[indexlist[i]],$
					' camera:',cam[indexlist[i]],' type:',typ[indexlist[i]],$
					' with a value of ',condField[indexList[i]]
end

pro write_comp_errors, infile

	catch, file_error

	readcol,infile,id,ts,age,cam,fil,typ,px,py,ser,mag,rad,ba,ang,dis,$
		SKIPLINE=2,FORMAT='A,A,F,A,A,A'
	
	IF file_error NE 0 THEN STOP
	
	out_filename = (strmid(infile,0,strpos(infile,'.'))+'_all_errors.txt')
	
	errors = where(strmid(id,0,1) EQ '*', errorCount)
				
	get_lun,outfile
	openw,outfile,out_filename
	printf,outfile,'two component (bulge) fits'
	printf,outfile,''
	printf,outfile,errorCount,' errors detected by sersic index and component separation, if any'
	printf,outfile,''
	printf,outfile,'components with x position below 280'  
	write_comp_list, outfile, where(px LT 280), id, ts, cam, typ, px
	printf,outfile,''
	printf,outfile,'components with x position above 320'                                           
	write_comp_list, outfile, where(px GT 320), id, ts, cam, typ, px
	printf,outfile,''
	printf,outfile,'components with y position below 280'                                              
	write_comp_list, outfile, where(py LT 280), id, ts, cam, typ, py
	printf,outfile,''    
	printf,outfile,'components with y position above 320'                                                                                 
	write_comp_list, outfile, where(py GT 320), id, ts, cam, typ, py
	printf,outfile,''
	free_lun,outfile
	
	print,'file written'

end